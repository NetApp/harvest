
name:       SecurityAccount
query:      security-login-get-iter
object:     security_account

counters:
  security-login-account-info:
    - ^^user-name                                 => user_name
    - ^^application                               => applications
    - ^^vserver                                   => svm
    - ^^authentication-method                     => methods
    - ^^remote-switch-ipaddress                   => remote_switch_ipaddress
    - ^role-name                                  => role_name
    - ^password-hash-algorithm                    => hash_algorithm
    - ^is-locked                                  => locked

collect_only_labels: true

plugins:
  - LabelAgent:
      value_to_num_regex:
        - samluser methods .*saml.*$ .*saml.*$ `0`
        - ldapuser methods .*nsswitch.*$ .*nsswitch.*$ `0`
        - certificateuser methods .*cert.*$ .*certificate.*$ `0`
        - localuser methods .*password.*$ .*password.*$ `0`
        - activediruser methods .*domain.*$ .*domain.*$ `0`

export_options:
  instance_keys:
    - user_name
    - applications
    - svm
    - methods
    - remote_switch_ipaddress
  instance_labels:
    - role_name
    - hash_algorithm
    - locked