
name:       SVM
query:      vserver-get-iter
object:     svm

counters:
  vserver-info:
    - ^^uuid                                  => svm_uuid
    - ^vserver-name                           => svm
    - ^state                                  => state
    - ^vserver-type                           => type
    - ^anti-ransomware-default-volume-state   => anti_ransomware_state
    - name-server-switch:
        - ^nsswitch                           => nameservice_switch

collect_only_labels: true

plugins:
  - SVM:
      schedule:
        - data: 900s  # should be multiple of data poll duration
  - LabelAgent:
      replace:
        - type root_svm `data` `No`
        - type root_svm `node` `Yes`
        - type root_svm `admin` `Yes`
        - type root_svm `system` `Yes`
      value_to_num:
        - new_status state online online `0`
        - ldap_signed ldap_session_security sign sign `0`
        - ldap_encrypted ldap_session_security seal seal `0`

export_options:
  instance_keys:
    - svm
    - root_svm
  instance_labels:
    - state
    - anti_ransomware_state
    - nis_authentication_enabled
    - audit_protocol_enabled
    - cifs_ntlm_enabled
    - cifs_protocol_enabled
    - nfs_protocol_enabled
    - nis_domain
    - ns_source
    - ns_db
    - ciphers
    - iscsi_authentication_type
    - iscsi_service_enabled
    - fpolicy_enabled
    - fpolicy_name
    - ldap_session_security
    - nfs_kerberos_protocol_enabled
    - smb_encryption_required
    - smb_signing_required
    - type

