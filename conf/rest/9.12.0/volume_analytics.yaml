name:                     VolumeAnalytics
query:                    api/storage/volumes
object:                   volume

counters:
  - ^^uuid                                        => uuid
  - ^name                                         => volume
  - ^svm.name                                     => svm
  # The 'filter' section is used to collect File System Analytics (FSA) for the top 20 volumes.
  # This includes both FlexVol and FlexGroup volumes, sorted by maximum size.
  - filter:
      - analytics.state=on  # Ensure analytics is turned on
      - order_by=space.used desc  # Sort volumes in descending order based on used space
      - max_records=20  # Limit the records to the top 20 volumes

plugins:
  # The 'VolumeAnalytics' plugin collects analytics data from directories within each volume.
  - VolumeAnalytics:
      # 'MaxDirectoryCount' specifies the number of directories to collect per volume.
      # In this case, data is collected from up to 100 directories, prioritizing those with the highest used bytes.
      - MaxDirectoryCount: 100
      # The following sample URL gets called per volume in the VolumeAnalytics plugin:
      # api/storage/volumes/375dd429-802b-11ed-a5cd-00a098d39e12/files?return_records=true&fields=analytics.file_count,analytics.bytes_used,analytics.subdir_count,analytics.by_modified_time.bytes_used,analytics.by_accessed_time.bytes_used&order_by=analytics.bytes_used+desc&type=directory&max_records=100




