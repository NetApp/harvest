# As private cli api would provide all svms(but system) which we would need for our use-case, So using private api instead of public.

name:                     SVM
query:                    api/private/cli/vserver
object:                   svm

counters:
  - ^^uuid                                  => svm_uuid
  - ^vserver                                => svm
  - ^anti_ransomware_default_volume_state   => anti_ransomware_state
  - ^operational_state                      => state

endpoints:
  - query: api/svm/svms
    counters:
      - ^^uuid                              => svm_uuid
      - ^nsswitch                           => nameservice_switch
  - query: api/security/ssh/svms
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^ciphers                            => ciphers
  - query: api/protocols/cifs/services
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^enabled                            => cifs_protocol_enabled
      - ^security.smb_encryption            => smb_encryption_required
      - ^security.smb_signing               => smb_signing_required
      - ^security.lm_compatibility_level    => cifs_ntlm_enabled
  - query: api/protocols/nfs/services
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^enabled                            => nfs_protocol_enabled
  - query: api/protocols/audit
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^enabled                            => audit_protocol_enabled
  - query: api/protocols/fpolicy     # need to test
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^policies.enabled                   => fpolicy_enabled
      - ^policies.name                      => fpolicy_name
  - query: api/name-services/nis
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^domain                             => nis_domain
  - query: api/name-services/ldap
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^session_security                   => ldap_session_security
  - query: api/protocols/nfs/kerberos/interfaces
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^enabled                            => nfs_kerberos_protocol_enabled
  - query: api/protocols/san/iscsi/credentials
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^authentication_type                => iscsi_authentication_type
  - query: api/protocols/san/iscsi/services
    counters:
      - ^^svm.uuid                          => svm_uuid
      - ^enabled                            => iscsi_service_enabled
plugins:
  - SVM
  - LabelAgent:
      value_to_num:
        - new_status state online online `0`
        - ldap_signed ldap_session_security sign sign `0`
        - ldap_encrypted ldap_session_security seal seal `0`

export_options:
  instance_keys:
    - svm
  instance_labels:
    - state
    - anti_ransomware_state
    - ciphers
    - cifs_protocol_enabled
    - smb_encryption_required
    - smb_signing_required
    - cifs_ntlm_enabled
    - nfs_protocol_enabled
    - audit_protocol_enabled
    - fpolicy_enabled
    - fpolicy_name
    - nis_domain
    - ldap_session_security
    - nfs_kerberos_protocol_enabled
    - iscsi_authentication_type
    - iscsi_service_enabled
    - nis_authentication_enabled
    - ns_source
    - ns_db

