
name:             SecurityAccount
query:            api/security/accounts
object:           security_account

counters:
  - ^^name                                      => user_name
  - ^^owner.name                                => svm
  - ^role.name                                  => role_name
  - ^password_hash_algorithm                    => hash_algorithm
  - ^locked                                     => locked
  - ^applications.#.application                 => applications
  - ^applications.#.authentication_methods.0    => methods


plugins:
  - LabelAgent:
      value_to_num_regex:
        - samluser methods .*saml.*$ .*saml.*$ `0`
        - ldapuser methods .*nsswitch.*$ .*nsswitch.*$ `0`
        - certificateuser methods .*cert.*$ .*certificate.*$ `0`
        - localuser methods .*password.*$ .*password.*$ `0`
        - activediruser methods .*domain.*$ .*domain.*$ `0`

export_options:
  instance_keys:
    - user_name
    - svm
  instance_labels:
    - role_name
    - hash_algorithm
    - locked
    - applications
    - methods
