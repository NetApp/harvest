
name:               Aggregate
query:              api/storage/aggregates
object:             aggr

counters:
  - ^name                                                          => aggr
  - ^^uuid                                                         => uuid
  - ^home_node.name                                                => node
  - ^state                                                         => state
  - ^block_storage.primary.disk_type                               => type
  - ^block_storage.primary.raid_type                               => raid_type
  - block_storage.primary.raid_size                                => raid_size
  - space.cloud_storage.used                                       => space_capacity_tier_used
  - space.block_storage.data_compacted_count                       => space_data_compacted_count
  - space.block_storage.data_compaction_space_saved                => space_data_compaction_saved
  - space.block_storage.data_compaction_space_saved_percent        => space_data_compaction_saved_percent
  - block_storage.hybrid_cache.size                                => hybrid_cache_size_total
  - space.block_storage.inactive_user_data                         => space_performance_tier_inactive_user_data
  - space.block_storage.inactive_user_data_percent                 => space_performance_tier_inactive_user_data_percent
  - space.block_storage.physical_used                              => space_physical_used
  - space.block_storage.physical_used_percent                      => space_used_percent
  - space.block_storage.volume_deduplication_shared_count          => space_sis_shared_count
  - space.block_storage.volume_deduplication_space_saved           => space_sis_saved
  - space.block_storage.volume_deduplication_space_saved_percent   => space_sis_saved_percent
  - space.block_storage.available                                  => space_available
  - space.block_storage.size                                       => space_total
  - space.block_storage.used                                       => space_used
  - snapshot.files_total                                           => snapshot_files_total
  - snapshot.files_used                                            => snapshot_files_used
  - snapshot.max_files_available                                   => snapshot_maxfiles_available
  - snapshot.max_files_used                                        => snapshot_maxfiles_used
  - space.snapshot.available                                       => snapshot_size_available
  - space.snapshot.used                                            => snapshot_size_used
  - space.snapshot.used_percent                                    => snapshot_used_percent
  - space.snapshot.reserve_percent                                 => snapshot_reserve_percent
  - space.snapshot.total                                           => snapshot_size_total
  - volume_count                                                   => volume_count_flexvol
  - block_storage.primary.disk_count                               => primary_disk_count
  - block_storage.hybrid_cache.disk_count                          => hybrid_disk_count
  - block_storage.plexes.#                                         => raid_plex_count
  - hidden_fields:
      - space

plugins:
  - LabelAgent:
      value_to_num:
        - new_status state online online `0`
      compute_metric:
        - snapshot_maxfiles_possible ADD snapshot.max_files_available snapshot.max_files_used
        - raid_disk_count ADD block_storage.primary.disk_count block_storage.hybrid_cache.disk_count

export_options:
  instance_keys:
    - aggr
    - node
  instance_labels:
    - type
    - state
