
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../configure-grafana/">
      
      
        <link rel="next" href="../configure-rest/">
      
      
      <link rel="icon" href="../assets/harvest.svg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.6">
    
    
      
        <title>ZAPI - Harvest</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#zapi-collector" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Harvest" class="md-header__button md-logo" aria-label="Harvest" data-md-component="logo">
      
  <img src="../assets/harvest.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Harvest
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ZAPI
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/NetApp/harvest" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    NetApp/harvest
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Harvest" class="md-nav__button md-logo" aria-label="Harvest" data-md-component="logo">
      
  <img src="../assets/harvest.svg" alt="logo">

    </a>
    Harvest
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/NetApp/harvest" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    NetApp/harvest
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is Harvest?
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/package-managers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Package Managers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Containers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Containers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/k8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    K8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/podman/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Podman
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/containerd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Containerd
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/native/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Native
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../system-requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Requirements
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prepare Monitored Clusters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Prepare Monitored Clusters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prepare-cdot-clusters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ONTAP cDOT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prepare-fsx-clusters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Amazon FSx for ONTAP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prepare-7mode-clusters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ONTAP 7mode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prepare-storagegrid-clusters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StorageGRID
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-harvest-basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Harvest (basic)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configure Exporters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Configure Exporters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prometheus-exporter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prometheus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../influxdb-exporter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InfluxDB
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-grafana/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Grafana
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configure Collectors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Configure Collectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ZAPI
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ZAPI
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zapi-collector" class="md-nav__link">
    <span class="md-ellipsis">
      Zapi Collector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Zapi Collector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-system" class="md-nav__link">
    <span class="md-ellipsis">
      Target System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collector-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Collector configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Object configuration file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zapiperf-collector" class="md-nav__link">
    <span class="md-ellipsis">
      ZapiPerf Collector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zapiperf" class="md-nav__link">
    <span class="md-ellipsis">
      ZapiPerf
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZapiPerf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metrics_1" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#harvest-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Harvest configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zapiperf-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      ZapiPerf configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-configuration-file_1" class="md-nav__link">
    <span class="md-ellipsis">
      Object configuration file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Object configuration file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#counters" class="md-nav__link">
    <span class="md-ellipsis">
      counters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_options" class="md-nav__link">
    <span class="md-ellipsis">
      export_options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter" class="md-nav__link">
    <span class="md-ellipsis">
      Filter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objects-excluding-workload" class="md-nav__link">
    <span class="md-ellipsis">
      Objects (Excluding Workload)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#workload-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Workload Templates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-ems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-storagegrid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StorageGRID
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-unix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unix
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templates
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dashboards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dashboards
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../manage-harvest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage Harvest Pollers
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure-harvest-advanced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Harvest (advanced)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitor-harvest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitor Harvest
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Help
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            Help
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../help/troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../help/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../help/log-collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Log Collection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../help/config-collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config Collection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Matrix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ontap-metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ONTAP Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/power-algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Power Algorithm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/rest-perf-metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Perf Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/rest-strategy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Strategy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/templates-and-metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templates And Metrics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_18" >
        
          
          <label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_18">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zapi-collector" class="md-nav__link">
    <span class="md-ellipsis">
      Zapi Collector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Zapi Collector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-system" class="md-nav__link">
    <span class="md-ellipsis">
      Target System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collector-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Collector configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Object configuration file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zapiperf-collector" class="md-nav__link">
    <span class="md-ellipsis">
      ZapiPerf Collector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zapiperf" class="md-nav__link">
    <span class="md-ellipsis">
      ZapiPerf
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZapiPerf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metrics_1" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#harvest-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Harvest configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zapiperf-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      ZapiPerf configuration file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-configuration-file_1" class="md-nav__link">
    <span class="md-ellipsis">
      Object configuration file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Object configuration file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#counters" class="md-nav__link">
    <span class="md-ellipsis">
      counters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_options" class="md-nav__link">
    <span class="md-ellipsis">
      export_options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter" class="md-nav__link">
    <span class="md-ellipsis">
      Filter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objects-excluding-workload" class="md-nav__link">
    <span class="md-ellipsis">
      Objects (Excluding Workload)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#workload-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Workload Templates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div class="admonition tip">
<p class="admonition-title">What about REST?</p>
<p>ZAPI will reach end of availablity in ONTAP  9.13.1 released Q2 2023.
Don't worry, Harvest has you covered. Switch to Harvest's REST collectors
and collect idential metrics. See <a href="https://github.com/NetApp/harvest/blob/main/docs/architecture/rest-strategy.md">REST Strategy</a> for more details. </p>
</div>
<h2 id="zapi-collector">Zapi Collector<a class="headerlink" href="#zapi-collector" title="Permanent link">&para;</a></h2>
<p>The Zapi collectors uses the ZAPI protocol to collect data from ONTAP systems. The collector submits data as received
from the target system, and does not perform any calculations or post-processing. Since the attributes of most APIs have
an irregular tree structure, sometimes a plugin will be required to collect all metrics from an API.</p>
<p>The <a href="#zapiperf-collector">ZapiPerf collector</a> is an extension of this collector, therefore they share many parameters
and configuration settings.</p>
<h3 id="target-system">Target System<a class="headerlink" href="#target-system" title="Permanent link">&para;</a></h3>
<p>Target system can be any cDot or 7Mode ONTAP system. Any version is supported, however the default configuration files
may not completely match with older systems.</p>
<h3 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h3>
<p>No SDK or other requirements. It is recommended to create a read-only user for Harvest on the ONTAP system (see 
<a href="../prepare-cdot-clusters/">prepare monitored clusters</a> for details)</p>
<h3 id="metrics">Metrics<a class="headerlink" href="#metrics" title="Permanent link">&para;</a></h3>
<p>The collector collects a dynamic set of metrics. Since most ZAPIs have a tree structure, the collector converts that
structure into a flat metric representation. No post-processing or calculation is performed on the collected data
itself.</p>
<p>As an example, the <code>aggr-get-iter</code> ZAPI provides the following partial attribute tree:</p>
<div class="highlight"><pre><span></span><code><span class="nt">aggr-attributes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">aggr-raid-attributes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">disk-count</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">aggr-snapshot-attributes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">files-total</span>
</code></pre></div>
<p>The Zapi collector will convert this tree into two "flat" metrics: <code>aggr_raid_disk_count</code>
and <code>aggr_snapshot_files_total</code>. (The algorithm to generate a name for the metrics will attempt to keep it as simple as
possible, but sometimes it's useful to manually set a short display name. See <a href="../configure-templates/#counters">counters</a>
for more details.</p>
<h3 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h3>
<p>The parameters and configuration are similar to those of the <a href="#zapiperf-collector">ZapiPerf collector</a>. Only the
differences will be discussed below.</p>
<h4 id="collector-configuration-file">Collector configuration file<a class="headerlink" href="#collector-configuration-file" title="Permanent link">&para;</a></h4>
<p>Parameters different from ZapiPerf:</p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>type</th>
<th>description</th>
<th>default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>schedule</code></td>
<td>required</td>
<td>same as for ZapiPerf, but only two elements: <code>instance</code> and <code>data</code> (collector does not run a <code>counter</code> poll)</td>
<td></td>
</tr>
<tr>
<td><code>no_max_records</code></td>
<td>bool, optional</td>
<td>don't add <code>max-records</code> to the ZAPI request</td>
<td></td>
</tr>
<tr>
<td><code>collect_only_labels</code></td>
<td>bool, optional</td>
<td>don't look for numeric metrics, only submit labels  (suppresses the <code>ErrNoMetrics</code> error)</td>
<td></td>
</tr>
<tr>
<td><code>only_cluster_instance</code></td>
<td>bool, optional</td>
<td>don't look for instance keys and assume only instance is the cluster itself</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="object-configuration-file">Object configuration file<a class="headerlink" href="#object-configuration-file" title="Permanent link">&para;</a></h4>
<p>The Zapi collector does not have the parameters <code>instance_key</code> and <code>override</code> parameters. The optional
parameter <code>metric_type</code> allows you to override the default metric type (<code>uint64</code>). The value of this parameter should be
one of the metric types supported by <a href="../resources/matrix/">the matrix data-structure</a>.</p>
<h2 id="zapiperf-collector">ZapiPerf Collector<a class="headerlink" href="#zapiperf-collector" title="Permanent link">&para;</a></h2>
<h1 id="zapiperf">ZapiPerf<a class="headerlink" href="#zapiperf" title="Permanent link">&para;</a></h1>
<p>ZapiPerf collects performance metrics from ONTAP systems using the ZAPI protocol. The collector is designed to be easily
extendable to collect new objects or to collect additional counters from already configured objects.</p>
<p>This collector is an extension of the <a href="#zapi-collector">Zapi collector</a>. The major difference between them is that
ZapiPerf collects only the performance (<code>perf</code>) APIs. Additionally, ZapiPerf always calculates final values from the
deltas of two subsequent polls.</p>
<h2 id="metrics_1">Metrics<a class="headerlink" href="#metrics_1" title="Permanent link">&para;</a></h2>
<p>The collector collects a dynamic set of metrics. The metric values are calculated from two consecutive polls (therefore,
no metrics are emitted after the first poll). The calculation algorithm depends on the <code>property</code> and <code>base-counter</code>
attributes of each metric, the following properties are supported:</p>
<table>
<thead>
<tr>
<th>property</th>
<th>formula</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>raw</td>
<td>x = x<sub>i</sub></td>
<td>no post-processing, value <strong>x</strong> is submitted as it is</td>
</tr>
<tr>
<td>delta</td>
<td>x = x<sub>i</sub> - x<sub>i-1</sub></td>
<td>delta of two poll values, <strong>x<sub>i<sub></strong> and <strong>x<sub>i-1<sub></strong></td>
</tr>
<tr>
<td>rate</td>
<td>x = (x<sub>i</sub> - x<sub>i-1</sub>) / (t<sub>i</sub> - t<sub>i-1</sub>)</td>
<td>delta divided by the interval of the two polls in seconds</td>
</tr>
<tr>
<td>average</td>
<td>x = (x<sub>i</sub> - x<sub>i-1</sub>) / (y<sub>i</sub> - y<sub>i-1</sub>)</td>
<td>delta divided by the delta of the base counter <strong>y</strong></td>
</tr>
<tr>
<td>percent</td>
<td>x = 100 * (x<sub>i</sub> - x<sub>i-1</sub>) / (y<sub>i</sub> - y<sub>i-1</sub>)</td>
<td>average multiplied by 100</td>
</tr>
</tbody>
</table>
<h2 id="parameters_1">Parameters<a class="headerlink" href="#parameters_1" title="Permanent link">&para;</a></h2>
<p>The parameters of the collector are distributed across three files:</p>
<ul>
<li><a href="../configure-harvest-basic/#pollers">Harvest configuration file</a> (default: <code>harvest.yml</code>)</li>
<li>ZapiPerf configuration file (default: <code>conf/zapiperf/default.yaml</code>)</li>
<li>Each object has its own configuration file (located in <code>conf/zapiperf/cdot/</code> and <code>conf/zapiperf/7mode/</code> for cDot and
  7Mode systems respectively)</li>
</ul>
<p>Except for <code>addr</code>, <code>datacenter</code> and <code>auth_style</code>, all other parameters of the ZapiPerf collector can be
defined in either of these three files. Parameters defined in the lower-level file, override parameters in the
higher-level file. This allows the user to configure each objects individually, or use the same parameters for all
objects.</p>
<p>The full set of parameters are described <a href="#zapiperf-configuration-file">below</a>.</p>
<h3 id="harvest-configuration-file">Harvest configuration file<a class="headerlink" href="#harvest-configuration-file" title="Permanent link">&para;</a></h3>
<p>Parameters in poller section should define (at least) the address and authentication method of the target system:</p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>type</th>
<th>description</th>
<th>default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>addr</code></td>
<td>string, required</td>
<td>address (IP or FQDN) of the ONTAP system</td>
<td></td>
</tr>
<tr>
<td><code>datacenter</code></td>
<td>string, required</td>
<td>name of the datacenter where the target system is located</td>
<td></td>
</tr>
<tr>
<td><code>auth_style</code></td>
<td>string, optional</td>
<td>authentication method: either <code>basic_auth</code> or <code>certificate_auth</code></td>
<td><code>basic_auth</code></td>
</tr>
<tr>
<td><code>ssl_cert</code>, <code>ssl_key</code></td>
<td>string, optional</td>
<td>full path of the SSL certificate and key pairs (when using <code>certificate_auth</code>)</td>
<td></td>
</tr>
<tr>
<td><code>username</code>, <code>password</code></td>
<td>string, optional</td>
<td>full path of the SSL certificate and key pairs (when using <code>basic_auth</code>)</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="zapiperf-configuration-file">ZapiPerf configuration file<a class="headerlink" href="#zapiperf-configuration-file" title="Permanent link">&para;</a></h3>
<p>This configuration file (the "template") contains a list of objects that should be collected and the filenames of their
configuration (explained in the next section).</p>
<p>Additionally, this file contains the parameters that are applied as defaults to all objects. (As mentioned before, any
of these parameters can be defined in the Harvest or object configuration files as well).</p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>type</th>
<th>description</th>
<th>default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>use_insecure_tls</code></td>
<td>bool, optional</td>
<td>skip verifying TLS certificate of the target system</td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>client_timeout</code></td>
<td>duration (Go-syntax)</td>
<td>how long to wait for server responses</td>
<td>30s</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td>int, optional</td>
<td>max instances per API request</td>
<td><code>500</code></td>
</tr>
<tr>
<td><code>latency_io_reqd</code></td>
<td>int, optional</td>
<td>threshold of IOPs for calculating latency metrics (latencies based on very few IOPs are unreliable)</td>
<td><code>10</code></td>
</tr>
<tr>
<td><code>schedule</code></td>
<td>list, required</td>
<td>the poll frequencies of the collector/object, should include exactly these three elements in the exact same other:</td>
<td></td>
</tr>
<tr>
<td>- <code>counter</code></td>
<td>duration (Go-syntax)</td>
<td>poll frequency of updating the counter metadata cache (example value: <code>20m</code>)</td>
<td></td>
</tr>
<tr>
<td>- <code>instance</code></td>
<td>duration (Go-syntax)</td>
<td>poll frequency of updating the instance cache (example value: <code>10m</code>)</td>
<td></td>
</tr>
<tr>
<td>- <code>data</code></td>
<td>duration (Go-syntax)</td>
<td>poll frequency of updating the data cache (example value: <code>1m</code>)<br /><br /><strong>Note</strong> Harvest allows defining poll intervals on sub-second level (e.g. <code>1ms</code>), however keep in mind the following:<br /><ul><li>API response of an ONTAP system can take several seconds, so the collector is likely to enter failed state if the poll interval is less than <code>client_timeout</code>.</li><li>Small poll intervals will create significant workload on the ONTAP system, as many counters are aggregated on-demand.</li><li>Some metric values become less significant if they are calculated for very short intervals (e.g. latencies)</li></ul></td>
<td></td>
</tr>
</tbody>
</table>
<p>The template should define objects in the <code>objects</code> section. Example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">objects</span><span class="p">:</span>
<span class="w">  </span><span class="nt">SystemNode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system_node.yaml</span>
<span class="w">  </span><span class="nt">HostAdapter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostadapter.yaml</span>
</code></pre></div>
<p>Note that for each object we only define the filename of the object configuration file. The object configuration files
are located in subdirectories matching to the ONTAP version that was used to create these files. It is possible to have
multiple version-subdirectories for multiple ONTAP versions. At runtime, the collector will select the object
configuration file that closest matches to the version of the target ONTAP system. (A mismatch is tolerated since
ZapiPerf will fetch and validate counter metadata from the system.)</p>
<h3 id="object-configuration-file_1">Object configuration file<a class="headerlink" href="#object-configuration-file_1" title="Permanent link">&para;</a></h3>
<p>The Object configuration file ("subtemplate") should contain the following parameters:</p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>type</th>
<th>description</th>
<th>default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>display name of the collector that will collect this object</td>
<td></td>
</tr>
<tr>
<td><code>object</code></td>
<td>string</td>
<td>short name of the object</td>
<td></td>
</tr>
<tr>
<td><code>query</code></td>
<td>string</td>
<td>raw object name used to issue a ZAPI request</td>
<td></td>
</tr>
<tr>
<td><code>counters</code></td>
<td>list</td>
<td>list of counters to collect (see notes below)</td>
<td></td>
</tr>
<tr>
<td><code>instance_key</code></td>
<td>string</td>
<td>label to use as instance key (either <code>name</code> or <code>uuid</code>)</td>
<td></td>
</tr>
<tr>
<td><code>override</code></td>
<td>list of key-value pairs</td>
<td>override counter properties that we get from ONTAP (allows circumventing ZAPI bugs)</td>
<td></td>
</tr>
<tr>
<td><code>plugins</code></td>
<td>list</td>
<td>plugins and their parameters to run on the collected data</td>
<td></td>
</tr>
<tr>
<td><code>export_options</code></td>
<td>list</td>
<td>parameters to pass to exporters (see notes below)</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="counters"><code>counters</code><a class="headerlink" href="#counters" title="Permanent link">&para;</a></h4>
<p>This section defines the list of counters that will be collected. These counters can be labels, numeric metrics or
histograms. The exact property of each counter is fetched from ONTAP and updated periodically.</p>
<p>Some counters require a "base-counter" for post-processing. If the base-counter is missing, ZapiPerf will still run, but
the missing data won't be exported.</p>
<p>The display name of a counter can be changed with <code>=&gt;</code> (e.g., <code>nfsv3_ops =&gt; ops</code>). There's one conversion Harvest does
for you by default, the <code>instance_name</code> counter will be renamed to the value of <code>object</code>.</p>
<p>Counters that are stored as labels will only be exported if they are included in the <code>export_options</code> section.</p>
<h4 id="export_options"><code>export_options</code><a class="headerlink" href="#export_options" title="Permanent link">&para;</a></h4>
<p>Parameters in this section tell the exporters how to handle the collected data. The set of parameters varies by
exporter. For <a href="../prometheus-exporter/">Prometheus</a> and <a href="../influxdb-exporter/">InfluxDB</a>
exporters, the following parameters can be defined:</p>
<ul>
<li><code>instances_keys</code> (list): display names of labels to export with each data-point</li>
<li><code>instance_labels</code> (list): display names of labels to export as a separate data-point</li>
<li><code>include_all_labels</code> (bool): export all labels with each data-point (overrides previous two parameters)</li>
</ul>
<h3 id="filter">Filter<a class="headerlink" href="#filter" title="Permanent link">&para;</a></h3>
<p>This guide provides instructions on how to use the <code>filter</code> feature in ZapiPerf. Filtering is useful when you need to query a subset of instances. For example, suppose you have a small number of high-value volumes from which you want Harvest to collect performance metrics every five seconds. Collecting data from all volumes at this frequency would be too resource-intensive. Therefore, filtering allows you to create/modify a template that includes only the high-value volumes.</p>
<h4 id="objects-excluding-workload">Objects (Excluding Workload)<a class="headerlink" href="#objects-excluding-workload" title="Permanent link">&para;</a></h4>
<p>In ZapiPerf templates, you can set up filters under <code>counters</code>. Wildcards like * are useful if you don't want to specify all instances. Please note, ONTAP Zapi filtering does not support regular expressions, only wildcard matching with <code>*</code>.</p>
<p>For instance, to filter <code>volume</code> performance instances by instance name where the name is <code>NS_svm_nvme</code> or contains <code>Test</code>, use the following configuration in ZapiPerf <code>volume.yaml</code> under <code>counters</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">counters</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">- filter</span><span class="p p-Indicator">:</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance_name=NS_svm_nvme|instance_name=*Test*</span>
</code></pre></div>
<p>You can define multiple values within the filter array. These will be interpreted as <code>AND</code> conditions by ONTAP. Alternatively, you can specify a complete expression within a single array element, as described in the ONTAP filtering section below.</p>
<details class="info">
<summary>ONTAP Filtering Details</summary>
<p>For a better understanding of ONTAP's filtering mechanism, it allows the use of <code>filter-data</code> for the <code>perf-object-instance-list-info-iter</code> Zapi.</p>
<p>The <code>filter-data</code> is a string that signifies filter data, adhering to the format: <code>counter_name=counter_value</code>. You can define multiple pairs, separated by either a comma (",") or a pipe ("|").</p>
<p>Here's the interpretation:</p>
<ul>
<li>A comma (",") signifies an AND operation.</li>
<li>A pipe ("|") signifies an OR operation.</li>
<li>The precedence order is AND first, followed by OR.</li>
</ul>
<p>For instance, the filter string <code>instance_name=volA,vserver_name=vs1|vserver_name=vs2</code> translates to <code>(instance_name=volA &amp;&amp; vserver_name=vs1) || (vserver_name=vs2)</code>.</p>
<p>This filter will return instances on Vserver <code>vs1</code> named <code>volA</code>, and all instances on Vserver <code>vs2</code>.</p>
</details>
<h4 id="workload-templates">Workload Templates<a class="headerlink" href="#workload-templates" title="Permanent link">&para;</a></h4>
<p>Performance workload templates require a different syntax because instances are retrieved from the <code>qos-workload-get-iter</code> ZAPI instead of <code>perf-object-instance-list-info-iter</code>.</p>
<p>The <code>qos-workload-get-iter</code> ZAPI supports filtering on the following fields:</p>
<ul>
<li>workload-uuid</li>
<li>workload-name</li>
<li>wid</li>
<li>category</li>
<li>policy-group</li>
<li>vserver</li>
<li>volume</li>
<li>lun</li>
<li>file</li>
<li>qtree</li>
<li>read-ahead</li>
<li>max-throughput</li>
<li>min-throughput</li>
<li>is-adaptive</li>
<li>is-constituent</li>
</ul>
<p>You can include these fields under the <code>filter</code> parameter. For example, to filter Workload performance instances by <code>workload-name</code> where the name contains <code>NS</code> or <code>Test</code> and <code>vserver</code> is <code>vs1</code>, use the following configuration in ZapiPerf <code>workload.yaml</code> under <code>counters</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">counters</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">- filter</span><span class="p p-Indicator">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">workload-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*NS*|*Test*&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">vserver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vs1</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; NetApp
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/NetApp/harvest/blob/main/SUPPORT.md#getting-help" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/NetApp/harvest/discussions" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.e1c3ead8.min.js"></script>
      
    
  </body>
</html>